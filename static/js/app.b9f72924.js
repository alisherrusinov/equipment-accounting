(function(e){function t(t){for(var a,s,c=t[0],i=t[1],l=t[2],p=0,d=[];p<c.length;p++)s=c[p],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,c=1;c<n.length;c++){var i=n[c];0!==r[i]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},o=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=i;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"0dc4":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("NavBar"),n("router-view")],1)},o=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{staticClass:"navbar navbar-expand-lg navbar-light bg-light"},[n("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[e._v("Navbar")]),e._m(0),n("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarSupportedContent"}},[n("ul",{staticClass:"navbar-nav mr-auto"},[null==e.accessToken?n("router-link",{attrs:{to:{name:"login"}},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.href,r=(t.route,t.navigate);return[n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",attrs:{href:a},on:{click:r}},[e._v("Вход")])])]}}],null,!1,4185969599)}):e._e(),null!=e.accessToken?n("router-link",{attrs:{to:{name:"logout"}},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.href,r=(t.route,t.navigate);return[n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",attrs:{href:a},on:{click:r}},[e._v("Выйти")])])]}}],null,!1,2211725944)}):e._e()],1)])])},c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[n("span",{staticClass:"navbar-toggler-icon"})])}],i=n("2f62"),l={name:"NavBar",computed:Object(i["b"])(["accessToken"])},u=l,p=(n("c92d"),n("2877")),d=Object(p["a"])(u,s,c,!1,null,"aeb23ee6",null),m=d.exports,f={name:"App",components:{NavBar:m}},h=f,b=(n("034f"),Object(p["a"])(h,r,o,!1,null,null,null)),g=b.exports,v=n("8c4f"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"input-group"},[n("span",{staticClass:"input-group-addon"},[e._v("Поиск")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"form-control",attrs:{id:"filter",type:"text",placeholder:"Поиск"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),n("table",{staticClass:"table table-striped table-bordered"},[n("thead",[n("tr",[n("th",{attrs:{scope:"col","data-param-name":"equipment_type"}},[e._v("Тип")]),n("th",{attrs:{scope:"col","data-param-name":"manufacturer"},on:{click:e.sort_col}},[e._v("Производитель")]),n("th",{attrs:{scope:"col","data-param-name":"name"},on:{click:e.sort_col}},[e._v("Наименование оборудования")]),n("th",{attrs:{scope:"col","data-param-name":"price"},on:{click:e.sort_col}},[e._v("Стоимость оборудования")]),n("th",{attrs:{scope:"col","data-param-name":"owner"},on:{click:e.sort_col}},[e._v("Принадлежность оборудования")]),n("th",{attrs:{scope:"col","data-param-name":"belonging"},on:{click:e.sort_col}},[e._v("Закрепление оборудования за сотрудниками")]),n("th",{attrs:{scope:"col","data-param-name":"number"},on:{click:e.sort_col}},[e._v("Накладной номер оборудования")]),n("th",{attrs:{scope:"col","data-param-name":"date_in"},on:{click:e.sort_col}},[e._v("Дата получения оборудования")]),n("th",{attrs:{scope:"col","data-param-name":"date_out"},on:{click:e.sort_col}},[e._v("Дата списания/выдачи оборудования из ремонта")])])]),n("tbody",e._l(e.searchResults,(function(t){return n("tr",{key:t.id,attrs:{id:t.id}},[n("td",{attrs:{"data-param-name":"equipment_type"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(" "+e._s(t.equipment_type))]),n("td",{attrs:{"data-param-name":"manufacturer"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.manufacturer)+" ")]),n("td",{attrs:{"data-param-name":"name"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.name))]),n("td",{attrs:{"data-param-name":"price"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.price))]),n("td",{attrs:{"data-param-name":"owner"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.owner))]),n("td",{attrs:{"data-param-name":"belonging"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.belonging)+" ")]),n("td",{attrs:{"data-param-name":"number"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.number))]),n("td",{attrs:{"data-param-name":"date_in"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.date_in))]),n("td",{attrs:{"data-param-name":"date_out"},on:{dblclick:e.onclick_,blur:e.onblur_,input:e.onInput}},[e._v(e._s(t.date_out)+" ")])])})),0)])])},k=[],y=(n("8e6e"),n("456d"),n("768b")),w=(n("ffc1"),n("ac6a"),n("386d"),n("bd86")),O=(n("c5f6"),n("55dd"),n("96cf"),n("3b8d")),j=n("bc3a"),C=n.n(j);n("7f7f");a["a"].use(i["a"]);var P=new i["a"].Store({state:{accessToken:localStorage.getItem("access_token")||null,refreshToken:localStorage.getItem("refresh_token")||null,elements:[],isEditable:!1},getters:{loggedIn:function(e){return null!=e.accessToken}},mutations:{updateLocalStorage:function(e,t){var n=t.access,a=t.refresh;localStorage.setItem("access_token",n),localStorage.setItem("refresh_token",a),e.accessToken=n,e.refreshToken=a},updateAccess:function(e,t){e.accessToken=t},destroyToken:function(e){e.accessToken=null,e.refreshToken=null}},actions:{refreshToken:function(e){return new Promise((function(t,n){S.post("/api/token/refresh/",{refresh:e.state.refreshToken}).then((function(n){console.log("New access successfully generated"),e.commit("updateAccess",n.data.access),t(n.data.access)})).catch((function(e){console.log("error in refreshToken Task"),n(e)}))}))},registerUser:function(e,t){return new Promise((function(e,n){S.post("/register/",{name:t.name,email:t.email,username:t.username,password:t.password,confirm:t.confirm}).then((function(t){e(t)})).catch((function(e){n(e)}))}))},logoutUser:function(e){if(e.getters.loggedIn)return new Promise((function(t,n){S.post("/api/token/logout/").then((function(t){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e.commit("destroyToken")})).catch((function(n){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e.commit("destroyToken"),t(n)}))}))},loginUser:function(e,t){return new Promise((function(n,a){S.post("/api/token/",{username:t.username,password:t.password}).then((function(t){e.commit("updateLocalStorage",{access:t.data.access,refresh:t.data.refresh}),n()})).catch((function(e){a(e)}))}))}}}),I="https://yzbekindustries.pythonanywhere.com/",S=C.a.create({baseURL:I,headers:{contentType:"application/json"}}),T=C.a.create({baseURL:I});function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){Object(w["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}T.interceptors.response.use(void 0,(function(e){e.config&&e.response&&401===e.response.status&&P.dispatch("refreshToken").then((function(e){C.a.request({baseURL:I,method:"get",headers:{Authorization:"Bearer ".concat(e)},url:"/list/"}).then((function(e){console.log("Success getting the Mods"),P.state.APIData=e.data})).catch((function(e){return console.log("Got the new access token but error while trying to fetch data from the API using it"),Promise.reject(e)}))})).catch((function(e){return Promise.reject(e)}))}));var A={name:"Downloads",components:{},data:function(){return{sort_by:"",sort:"",search:""}},methods:{sort_col:function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.target.dataset.paramName,""===this.sort||"ASC"===this.sort?this.sort="DESC":this.sort="ASC",this.sort_by=n,a=new FormData,a.append("attribute",n),a.append("sort",this.sort),e.next=8,fetch("http://127.0.0.1:8000/sorted",{method:"post",body:a});case 8:return r=e.sent,e.next=11,r.json();case 11:o=e.sent,this.$store.state.elements=o.elements;case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onclick_:function(e){this.isEditable&&e.target.setAttribute("contenteditable","true")},onblur_:function(e){if(this.isEditable){e.target.setAttribute("contenteditable","false");var t=e.target.parentElement.id,n=e.target.dataset.paramName,a=e.target.innerHTML;this.elements[Number(t)][n]=a;var r=new FormData;r.append("element_id",t),r.append("attribute",n),r.append("value",a),fetch("http://127.0.0.1:8000/save",{method:"post",body:r})}},onInput:function(e){console.log(e)}},computed:E({searchResults:function(){var e=this;if(""===this.search)return this.elements;var t={};return Object.entries(this.elements).forEach((function(n){var a=Object(y["a"])(n,2),r=a[0],o=a[1];Object.entries(o).forEach((function(n){var a=Object(y["a"])(n,2),s=a[0],c=a[1];console.log(c),"id"!==s&&-1!==c.indexOf(e.search)&&(t[r]=o)}))})),console.log(t),t}},Object(i["b"])(["elements","isEditable"])),created:function(){var e=this;T.get("list",{headers:{Authorization:"Bearer ".concat(this.$store.state.accessToken)}}).then((function(t){console.log("GetAPI successfully got the mods"),e.$store.state.elements=t.data.elements})).catch((function(e){console.log(e)})),T.get("rights",{headers:{Authorization:"Bearer ".concat(this.$store.state.accessToken)}}).then((function(t){console.log("GetAPI successfully got the mods"),e.$store.state.isEditable=t.data.edit_group,console.log(e.$store.state.isEditable)})).catch((function(e){console.log(e)}))}},$=A,N=Object(p["a"])($,_,k,!1,null,null,null),D=N.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("form",{on:{submit:function(t){return t.preventDefault(),e.loginUser(t)}}},[e.wrongCred?n("h2",[e._v("Неверные данные!")]):e._e(),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"user"}},[e._v("Логин")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text",name:"username",id:"user"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),n("small",{staticClass:"form-text text-muted",attrs:{id:"emailHelp"}},[e._v("We'll never share your email with anyone else.")])]),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"exampleInputPassword1"}},[e._v("Пароль")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",name:"password",id:"pass"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Войти")])])])},q=[],L={name:"login",data:function(){return{username:"",password:"",wrongCred:!1}},methods:{loginUser:function(){var e=this;this.$store.dispatch("loginUser",{username:this.username,password:this.password}).then((function(){e.wrongCred=!1,e.$router.push({name:"home"})})).catch((function(t){console.log(t),e.wrongCred=!0}))}}},R=L,B=Object(p["a"])(R,U,q,!1,null,"478a301c",null),M=B.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"log"})},G=[],F={created:function(){var e=this;this.$store.dispatch("logoutUser").then((function(){e.$router.push({name:"home"})}))}},H=F,J=Object(p["a"])(H,z,G,!1,null,"2c899272",null),W=J.exports;a["a"].use(v["a"]);var K=new v["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:D,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:M,meta:{requiresLogged:!0}},{path:"/logout",name:"logout",component:W,meta:{requiresAuth:!0}}]});a["a"].config.productionTip=!1,K.beforeEach((function(e,t,n){e.matched.some((function(e){return e.meta.requiresAuth}))?P.getters.loggedIn?n():n({name:"login"}):e.matched.some((function(e){return e.meta.requiresLogged}))&&P.getters.loggedIn?n({name:"home"}):n()})),new a["a"]({router:K,store:P,render:function(e){return e(g)}}).$mount("#app")},"85ec":function(e,t,n){},c92d:function(e,t,n){"use strict";n("0dc4")}});
//# sourceMappingURL=app.b9f72924.js.map